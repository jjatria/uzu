#!/usr/bin/env perl6

use v6;
use Uzu;

multi MAIN('webserver', Str $build_dir) {
  Uzu::web-server(src_dir => $build_dir);
}

multi MAIN('build', Str $layout) {
  Uzu::config(base => './partials', layout => $layout);
  Uzu::render();
}

multi MAIN('watch', Str $layout) {

  unless 'partials'.IO.e {
    note "No partials files available";
    exit(1);
  }


  Uzu::config(base => './partials', layout => $layout);
  Uzu::watch();

}

sub USAGE {
  say q:to/END/;
      Usage:
        uzu webserver <build_dir> - Start local web server
        uzu build <layout>        - Render all templates to ./build
        uzu watch <layout>        - Start web server and re-render
                                    build on template modification
      END
}

# vim: ft=perl6
